{"ast":null,"code":"import _toConsumableArray from\"D:/documents/js/time-management-tool/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"D:/documents/js/time-management-tool/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{json}from\"react-router\";import Menu from\"../menu\";import{useEffect,useRef,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Importpage=function Importpage(_ref){var data=_ref.data,setData=_ref.setData,settingprofile=_ref.settingprofile,setsettingprofile=_ref.setsettingprofile,rerenderStatus=_ref.rerenderStatus,colorstatus=_ref.colorstatus;/*---------------------------------*/useEffect(function(){if(localStorage.getItem(\"user\")!=null){setData(JSON.parse(localStorage.getItem(\"user\")).posts);}},[\"a\"]);useEffect(function(){if(rerenderStatus.current==false){return;}else{localStorage.setItem('user',JSON.stringify({\"posts\":data}));rerenderStatus.current=false;}},[data]);/*---------------------------------*/useEffect(function(){if(colorstatus.current==true){localStorage.setItem(\"setting\",JSON.stringify(settingprofile));colorstatus.current=false;}},[settingprofile]);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),InputData=_useState2[0],setInputData=_useState2[1];var DataInput=function DataInput(e){var reader=new FileReader();reader.readAsText(e.target.files[0]);reader.onload=function(i){setInputData(JSON.parse(i.target.result));};};var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),InputProfile=_useState4[0],setInputProfile=_useState4[1];var ProfileInput=function ProfileInput(e){var reader=new FileReader();reader.readAsText(e.target.files[0]);reader.onload=function(i){setInputProfile(JSON.parse(i.target.result));};};var replacedata=function replacedata(){rerenderStatus.current=true;setData(InputData.posts);};var replaceprofile=function replaceprofile(){colorstatus.current=true;setsettingprofile(InputProfile);var cachesetting=new Object(settingprofile);localStorage.setItem(\"setting\",JSON.stringify(cachesetting));};var mergedata=function mergedata(){rerenderStatus.current=true;setData(function(prev){return[].concat(_toConsumableArray(InputData.posts),_toConsumableArray(prev));});};var mergeprofile=function mergeprofile(){colorstatus=true;var inputlist=InputProfile.group.map(function(i){return i.name;});var buf=new Object(settingprofile).group.filter(function(i){return inputlist.includes(i.name)==false;});setsettingprofile({\"group\":[].concat(_toConsumableArray(InputProfile.group),_toConsumableArray(buf))});};return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"importpage\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u8CC7\\u6599\\u7BA1\\u7406\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"importcontainer\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"import\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u532F\\u5165\\u8CC7\\u6599\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".json, .csv\",onChange:DataInput}),function(){if(Array.isArray(InputData[\"posts\"])){return/*#__PURE__*/_jsxs(\"div\",{className:\"inputbuttoncontainer\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"datainputbutton\",onClick:replacedata,children:\"\\u53D6\\u4EE3\"}),/*#__PURE__*/_jsx(\"button\",{className:\"datainputbutton\",onClick:mergedata,children:\"\\u5408\\u4F75\"})]});}}()]}),/*#__PURE__*/_jsxs(\"div\",{id:\"import\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u532F\\u5165\\u8A2D\\u5B9A\\u6A94\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".json, .csv\",onChange:ProfileInput}),function(){if(InputProfile!=\"\"){return/*#__PURE__*/_jsxs(\"div\",{className:\"inputbuttoncontainer\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"profileinputbutton\",onClick:replaceprofile,children:\"\\u53D6\\u4EE3\"}),/*#__PURE__*/_jsx(\"button\",{className:\"profileinputbutton\",onClick:mergeprofile,children:\"\\u5408\\u4F75\"})]});}}()]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u532F\\u51FA\\u8CC7\\u6599\"}),/*#__PURE__*/_jsx(\"a\",{id:\"export\",href:\"data:text/json;charset=utf-8,\".concat(encodeURIComponent(JSON.stringify(data))),download:\"data.json\",children:\"Download Json\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u532F\\u51FA\\u8A2D\\u5B9A\\u6A94\"}),/*#__PURE__*/_jsx(\"a\",{id:\"export\",href:\"data:text/json;charset=utf-8,\".concat(encodeURIComponent(JSON.stringify(settingprofile))),download:\"profile.json\",children:\"Download Json\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space\"})]}),/*#__PURE__*/_jsx(Menu,{})]});};export default Importpage;","map":{"version":3,"names":["json","Menu","useEffect","useRef","useState","jsx","_jsx","jsxs","_jsxs","Importpage","_ref","data","setData","settingprofile","setsettingprofile","rerenderStatus","colorstatus","localStorage","getItem","JSON","parse","posts","current","setItem","stringify","_useState","_useState2","_slicedToArray","InputData","setInputData","DataInput","e","reader","FileReader","readAsText","target","files","onload","i","result","_useState3","_useState4","InputProfile","setInputProfile","ProfileInput","replacedata","replaceprofile","cachesetting","Object","mergedata","prev","concat","_toConsumableArray","mergeprofile","inputlist","group","map","name","buf","filter","includes","className","children","id","type","accept","onChange","Array","isArray","onClick","href","encodeURIComponent","download"],"sources":["D:/documents/js/time-management-tool/src/pages/import_file/import.js"],"sourcesContent":["import { json } from \"react-router\";\r\nimport Menu from \"../menu\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\nconst Importpage = ({ data, setData, settingprofile, setsettingprofile, rerenderStatus, colorstatus }) => {\r\n\r\n    /*---------------------------------*/\r\n\r\n    useEffect(()=> {\r\n        if (localStorage.getItem(\"user\") != null) {\r\n            setData(JSON.parse(localStorage.getItem(\"user\")).posts)\r\n        }\r\n    }, [\"a\"])\r\n\r\n    useEffect(()=> {\r\n        if (rerenderStatus.current == false) {\r\n            return;\r\n        } else {\r\n            localStorage.setItem('user', JSON.stringify({\r\n                \"posts\": data\r\n            }));\r\n            rerenderStatus.current = false; \r\n        }\r\n    }, [data]);\r\n\r\n    /*---------------------------------*/\r\n\r\n    useEffect(()=>{\r\n        if (colorstatus.current == true) {\r\n            localStorage.setItem(\"setting\", JSON.stringify(settingprofile));\r\n            colorstatus.current = false;\r\n        }\r\n    }, [settingprofile]);\r\n\r\n\r\n    const [InputData, setInputData] = useState(\"\");\r\n    const DataInput = (e) => {\r\n        let reader = new FileReader();\r\n        reader.readAsText(e.target.files[0])\r\n        reader.onload = (i) => {\r\n            setInputData(JSON.parse(i.target.result));    \r\n        }\r\n    }\r\n\r\n    const [InputProfile, setInputProfile] = useState(\"\");\r\n    const ProfileInput = (e) => {\r\n        let reader = new FileReader();\r\n        reader.readAsText(e.target.files[0])\r\n        reader.onload = (i) => {\r\n            setInputProfile(JSON.parse(i.target.result));    \r\n        }\r\n    }\r\n\r\n    const replacedata = () => {\r\n        rerenderStatus.current = true;\r\n        setData(InputData.posts);\r\n    }\r\n\r\n    const replaceprofile = () => {\r\n        colorstatus.current = true;\r\n        setsettingprofile(InputProfile)\r\n        let cachesetting = new Object(settingprofile);\r\n        localStorage.setItem(\"setting\", JSON.stringify(cachesetting));\r\n    }\r\n\r\n    const mergedata = () => {\r\n        rerenderStatus.current = true;\r\n        setData((prev)=>{\r\n            return [\r\n                ...(InputData.posts),\r\n                ...prev,\r\n            ]\r\n        })\r\n    }\r\n\r\n    const mergeprofile = () => {\r\n        colorstatus = true;\r\n        \r\n        let inputlist = InputProfile.group.map((i)=>i.name);\r\n        let buf = (new Object(settingprofile)).group.filter((i)=>inputlist.includes(i.name)==false);\r\n        setsettingprofile({\r\n            \"group\": [\r\n                ...(InputProfile.group),\r\n                ...buf,\r\n            ]\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div className=\"app\">\r\n            <div className=\"importpage\">\r\n                <h1>資料管理</h1>\r\n                <div className=\"importcontainer\">\r\n                    <div id=\"import\">\r\n                        <h3>匯入資料</h3>\r\n                        <input type=\"file\" accept=\".json, .csv\" onChange={DataInput} />\r\n                        {(()=>{\r\n                            if (Array.isArray(InputData[\"posts\"])) {\r\n                                return (\r\n                                    <div className=\"inputbuttoncontainer\">\r\n                                        <button className=\"datainputbutton\" onClick={replacedata}>取代</button>\r\n                                        <button className=\"datainputbutton\" onClick={mergedata}>合併</button>\r\n                                    </div>\r\n                                )\r\n                            }\r\n                        })()}\r\n                    </div>\r\n                    <div id=\"import\">\r\n                        <h3>匯入設定檔</h3>\r\n                        <input type=\"file\" accept=\".json, .csv\" onChange={ProfileInput} />\r\n                        {(()=>{\r\n                            if (InputProfile != \"\") {\r\n                                return (\r\n                                    <div className=\"inputbuttoncontainer\">\r\n                                        <button className=\"profileinputbutton\" onClick={replaceprofile}>取代</button>\r\n                                        <button className=\"profileinputbutton\" onClick={mergeprofile}>合併</button>\r\n                                    </div>\r\n                                )\r\n                            }\r\n                        })()}\r\n                    </div>\r\n                    <div>\r\n                        <h3>匯出資料</h3>\r\n                        <a\r\n                            id=\"export\"\r\n                            href={`data:text/json;charset=utf-8,${encodeURIComponent(\r\n                            JSON.stringify(data)\r\n                            )}`}\r\n                            download=\"data.json\"\r\n                        >\r\n                            {`Download Json`}\r\n                        </a>\r\n                    </div>\r\n                    <div>\r\n                        <h3>匯出設定檔</h3>\r\n                        <a\r\n                            id=\"export\"\r\n                            href={`data:text/json;charset=utf-8,${encodeURIComponent(\r\n                            JSON.stringify(settingprofile)\r\n                            )}`}\r\n                            download=\"profile.json\"\r\n                        >\r\n                            {`Download Json`}\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n                <div className=\"space\"></div>\r\n            </div>\r\n            <Menu />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Importpage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}